# 포동 PRD 요구사항 명세서 v4

## 1. 서비스 개요

| 항목           | 내용                                                                                     |
| -------------- | ---------------------------------------------------------------------------------------- |
| **서비스명**   | 포동 (포도 + 동화)                                                                       |
| **한 줄 소개** | 영어 콘텐츠 기반 미션을 통해 자녀의 학습을 관리하고, 포도알 보상으로 동기부여하는 서비스 |
| **타겟**       | 초등 저~중학년(8~11세) 자녀를 둔 부모                                                    |

---

## 2. 플랫폼

| 사용자 | 플랫폼         |
| ------ | -------------- |
| 운영자 | PC 웹 (어드민) |
| 부모   | PC 웹          |
| 자녀   | Flutter 앱     |

---

## 3. 핵심 구조 (콘텐츠/미션 분리)

```
[운영자]
콘텐츠 등록 (동화 스크립트 + 오디오 + 타임스탬프)
       ↓
[부모]
콘텐츠 탐색 → 콘텐츠 상세 → 미션 생성 → 미션 관리 → 자녀에게 할당
       ↓
[자녀]
할당된 미션 수행 → 포도알 획득 → Shop에서 보상 구매
```

---

## 4. 학습 플로우 (MVP: 동화 기준, 20분)

| 단계 | 활동        | 시간 | 미션 타입       |
| ---- | ----------- | ---- | --------------- |
| 1    | 듣기        | 5분  | - (콘텐츠 재생) |
| 2    | 문장 해석   | 5분  | sentence_match  |
| 3    | 단어 맞추기 | 5분  | word_quiz       |
| 4    | 문제 풀기   | 5분  | comprehension   |

※ 콘텐츠 타입에 따라 학습 플로우는 유연하게 구성 가능

---

## 5. 콘텐츠 생성 파이프라인

```
GPT로 콘텐츠 스크립트 생성
       ↓
Amazon Polly (Neural)
       ↓
오디오 파일 + Speech Marks (타임스탬프)
       ↓
어드민에서 업로드
```

---

## 6. 점수 및 보상 체계

### 6.1 점수 산정

| 단계        | 점수 산정             |
| ----------- | --------------------- |
| 듣기        | 완료 여부 (Pass/Fail) |
| 문장 해석   | 정답률                |
| 단어 맞추기 | 정답률                |
| 문제 풀기   | 정답률                |

### 6.2 포도알 지급 예시

| 평균 점수 | 포도알          |
| --------- | --------------- |
| 90% 이상  | 10알            |
| 70~89%    | 7알             |
| 50~69%    | 5알             |
| 50% 미만  | 3알 (참여 보상) |

※ 최종 포도알 개수는 부모가 미션 할당 시 설정

---

## 7. 보상 플로우

```
[부모] Shop에 보상 등록 (아이스크림 = 50알)
           ↓
[자녀] Shop에서 보상 확인 → "구매" 요청
           ↓
[부모] 구매 요청 알림 → 승인/거절
           ↓
[승인 시] 포도알 자동 차감 + 보상 완료
```

---

## 8. 요구사항 명세

### 8.1 운영자 (어드민)

#### 8.1.1 콘텐츠 관리

- 운영자는 콘텐츠를 등록할 수 있다.
  - 콘텐츠 타입을 선택할 수 있다. (story | song | video | ...)
  - 콘텐츠 제목을 입력할 수 있다.
  - 콘텐츠 스크립트(영문)를 입력할 수 있다.
  - 콘텐츠 스크립트(한글 번역)를 입력할 수 있다.
  - 오디오 파일(.mp3)을 업로드할 수 있다.
  - 타임스탬프 데이터(Speech Marks)를 업로드할 수 있다.
  - 난이도를 설정할 수 있다.
  - 썸네일 이미지를 업로드할 수 있다.
- 운영자는 등록된 콘텐츠 목록을 조회할 수 있다.
  - 콘텐츠 타입별로 필터링할 수 있다.
- 운영자는 콘텐츠를 수정할 수 있다.
- 운영자는 콘텐츠를 삭제할 수 있다.
- 운영자는 콘텐츠의 공개/비공개 상태를 설정할 수 있다.

---

### 8.2 부모

#### 8.2.1 인증

- 부모는 구글 계정으로 회원가입할 수 있다.
- 부모는 구글 계정으로 로그인할 수 있다.
- 부모는 로그아웃할 수 있다.

#### 8.2.2 자녀 계정 관리

- 부모는 자녀 계정을 생성할 수 있다.
  - 자녀 이름을 입력할 수 있다.
- 부모는 자녀 계정 생성 시 발급된 로그인 키를 확인할 수 있다.
- 부모는 로그인 키를 재발급할 수 있다.
  - 재발급 시 이전 키는 즉시 무효화된다.
- 부모는 자녀 이름을 수정할 수 있다.

#### 8.2.3 콘텐츠 탐색 및 미션 생성

**콘텐츠 목록**

- 부모는 공개된 콘텐츠 목록을 조회할 수 있다.
  - 콘텐츠 타입별로 필터링할 수 있다.
  - 난이도별로 필터링할 수 있다.
  - 썸네일, 제목, 난이도를 확인할 수 있다.

**콘텐츠 상세**

- 부모는 콘텐츠 상세 정보를 확인할 수 있다.
  - 제목, 난이도, 예상 소요 시간을 확인할 수 있다.
  - 스크립트(영문/한글)를 확인할 수 있다.
  - 오디오를 미리 들어볼 수 있다.
- 부모는 콘텐츠 상세에서 [미션 만들기]를 선택할 수 있다.

**미션 생성**

- 부모는 미션 타입을 선택할 수 있다.
- 부모는 미션 타입별 폼을 입력할 수 있다.
  - **문장 해석**: 영어 문장 + 한국어 뜻 쌍을 추가할 수 있다.
  - **단어 맞추기**: 단어 + 정답 뜻 + 오답 보기 3개를 추가할 수 있다.
  - **이해도 퀴즈**: 질문 + 보기 4개 + 정답을 추가할 수 있다.
- 부모는 미션 생성 중 콘텐츠 스크립트를 참고할 수 있다.
- 부모는 미션 이름을 입력할 수 있다.

#### 8.2.4 미션 관리

- 부모는 생성한 미션 목록을 조회할 수 있다.
  - 콘텐츠 제목, 미션 타입, 생성일을 확인할 수 있다.
- 부모는 미션을 수정할 수 있다.
- 부모는 미션을 삭제할 수 있다.

#### 8.2.5 미션 할당

- 부모는 생성한 미션을 자녀에게 할당할 수 있다.
  - 미션 완료 시 지급할 포도알 개수를 설정할 수 있다.
- 부모는 미션을 할당하면 자녀에게 Push 알림이 발송된다.
- 부모는 할당한 미션 목록을 조회할 수 있다.
  - 미션 상태를 확인할 수 있다. (대기/진행중/완료)
- 부모는 할당한 미션을 취소할 수 있다. (대기 상태일 때만)

#### 8.2.6 Shop 관리 (보상)

- 부모는 보상을 등록할 수 있다.
  - 보상 이름을 입력할 수 있다. (예: 아이스크림)
  - 필요한 포도알 개수를 설정할 수 있다.
  - 보상 이미지를 업로드할 수 있다. (선택)
- 부모는 등록된 보상 목록을 조회할 수 있다.
- 부모는 보상을 수정할 수 있다.
- 부모는 보상을 삭제할 수 있다.

#### 8.2.7 구매 요청 처리

- 부모는 자녀의 구매 요청 목록을 조회할 수 있다.
- 부모는 구매 요청을 승인할 수 있다.
  - 승인 시 자녀의 포도알이 자동 차감된다.
- 부모는 구매 요청을 거절할 수 있다.
  - 거절 시 사유를 입력할 수 있다. (선택)

#### 8.2.8 학습 현황 조회

- 부모는 자녀의 학습 현황을 조회할 수 있다.
  - 완료한 미션 목록을 확인할 수 있다.
  - 각 미션별 점수를 확인할 수 있다.
  - 획득한 총 포도알을 확인할 수 있다.
  - 현재 보유 포도알을 확인할 수 있다.

---

### 8.3 자녀

#### 8.3.1 인증

- 자녀는 부모에게 발급받은 키로 로그인할 수 있다.
- 자녀는 로그아웃할 수 있다.

#### 8.3.2 미션 확인

- 자녀는 부모가 할당한 미션 알림(Push)을 수신할 수 있다.
- 자녀는 할당된 미션 목록을 조회할 수 있다.
  - 콘텐츠 제목, 미션 타입, 포도알 보상을 확인할 수 있다.
- 자녀는 완료한 미션 목록을 조회할 수 있다.

#### 8.3.3 학습 수행

- 자녀는 미션을 시작할 수 있다.

**[1단계: 듣기]** _(콘텐츠에 오디오가 있는 경우)_

- 자녀는 콘텐츠 오디오를 재생할 수 있다.
- 자녀는 오디오 재생 중 자막 하이라이트를 볼 수 있다.
- 자녀는 오디오를 일시정지/재개할 수 있다.
- 자녀는 듣기를 완료하면 다음 단계로 진행할 수 있다.

**[2단계: 문장 해석]** _(미션 타입: sentence_match)_

- 자녀는 영어 문장과 한국어 뜻을 매칭할 수 있다.
- 자녀는 매칭 결과(정답/오답)를 즉시 확인할 수 있다.
- 자녀는 문장 해석을 완료하면 다음 단계로 진행할 수 있다.

**[3단계: 단어 맞추기]** _(미션 타입: word_quiz)_

- 자녀는 단어의 뜻을 4지선다로 선택할 수 있다.
- 자녀는 선택 결과(정답/오답)를 즉시 확인할 수 있다.
- 자녀는 단어 맞추기를 완료하면 다음 단계로 진행할 수 있다.

**[4단계: 문제 풀기]** _(미션 타입: comprehension)_

- 자녀는 이해도 퀴즈를 4지선다로 풀 수 있다.
- 자녀는 선택 결과(정답/오답)를 즉시 확인할 수 있다.
- 자녀는 문제 풀기를 완료하면 미션이 종료된다.

#### 8.3.4 보상 획득

- 자녀는 미션 완료 시 점수에 따른 포도알을 획득할 수 있다.
- 자녀는 획득한 포도알 결과를 확인할 수 있다.

#### 8.3.5 Shop (보상 구매)

- 자녀는 부모가 등록한 보상 목록을 조회할 수 있다.
  - 보상 이름, 필요 포도알을 확인할 수 있다.
- 자녀는 보유 포도알이 충분한 경우 구매 요청을 할 수 있다.
- 자녀는 구매 요청 상태를 확인할 수 있다. (대기중/승인/거절)
- 자녀는 구매 승인 시 알림을 수신할 수 있다.

#### 8.3.6 내 정보

- 자녀는 현재 보유 포도알을 확인할 수 있다.
- 자녀는 총 획득한 포도알을 확인할 수 있다.
- 자녀는 완료한 미션 수를 확인할 수 있다.

---

## 9. 부모 화면 흐름 (UX)

```
[콘텐츠 탐색]
    │
    ├── 콘텐츠 목록 (썸네일, 제목, 난이도)
    │
    └── 콘텐츠 상세
            ├── 기본 정보 (제목, 난이도, 소요 시간)
            ├── 스크립트 (영문/한글)
            ├── 오디오 미리듣기
            └── [미션 만들기] 버튼
                    │
                    └── 미션 타입 선택
                            │
                            └── 폼 입력 (스크립트 참고 가능)

[미션 관리]
    │
    ├── 내가 만든 미션 목록
    ├── 미션 수정/삭제
    └── 자녀에게 할당
```

---

## 10. MVP 범위

### 10.1 MVP In

| 사용자 | 기능                                                                                                                     |
| ------ | ------------------------------------------------------------------------------------------------------------------------ |
| 운영자 | 콘텐츠 등록/수정/삭제/공개 설정                                                                                          |
| 부모   | 구글 로그인, 자녀 계정 1개 생성, 콘텐츠 탐색, 미션 생성/수정/삭제, 미션 할당(Push), Shop 관리, 구매 승인/거절, 학습 현황 |
| 자녀   | 키 로그인, 미션 수행(4단계), 포도알 획득, Shop 구매 요청                                                                 |

### 10.2 MVP 콘텐츠 타입

- story (동화)

### 10.3 MVP 미션 타입

- sentence_match (문장 해석)
- word_quiz (단어 맞추기)
- comprehension (이해도 퀴즈)

### 10.4 MVP Out (이후 버전)

- 자녀 복수 계정 (Premium)
- 미션 통계/분석 (어드민)
- 추가 콘텐츠 타입 (song, video 등)
- 추가 미션 타입 (fill_blank 등)

---

## 11. 데이터 구조 (개념)

```
Content (콘텐츠) - 운영자가 생성
├── id
├── type (story | song | video | ...)
├── title
├── script_en
├── script_ko
├── audio_url
├── timestamps (JSON)
├── difficulty
├── thumbnail_url
├── is_public
├── created_at
└── updated_at

MissionType (미션 타입) - 시스템 고정
├── id
├── code (sentence_match | word_quiz | comprehension | ...)
├── name
└── description

Mission (미션) - 부모가 생성
├── id
├── parent_id (FK → Parent)
├── content_id (FK → Content)
├── mission_type_id (FK → MissionType)
├── name
├── data (JSON: 미션별 문제/정답 데이터)
├── created_at
└── updated_at

Parent (부모)
├── id
├── google_id
├── email
├── name
├── created_at
└── updated_at

Child (자녀)
├── id
├── parent_id (FK → Parent)
├── name
├── login_key
├── grape_balance
├── created_at
└── updated_at

Assignment (미션 할당)
├── id
├── child_id (FK → Child)
├── mission_id (FK → Mission)
├── grape_reward
├── status (pending | in_progress | completed)
├── score
├── completed_at
├── created_at
└── updated_at

Reward (보상)
├── id
├── parent_id (FK → Parent)
├── name
├── grape_cost
├── image_url
├── created_at
└── updated_at

PurchaseRequest (구매 요청)
├── id
├── child_id (FK → Child)
├── reward_id (FK → Reward)
├── status (pending | approved | rejected)
├── reject_reason
├── created_at
└── updated_at
```

---

## 12. 미션 타입별 데이터 구조 (JSON)

### 12.1 문장 해석 (sentence_match)

```json
{
  "items": [
    {
      "en": "The little rabbit was very hungry.",
      "ko": "작은 토끼는 매우 배가 고팠습니다."
    },
    {
      "en": "He found a big carrot in the garden.",
      "ko": "그는 정원에서 큰 당근을 찾았습니다."
    }
  ]
}
```

### 12.2 단어 맞추기 (word_quiz)

```json
{
  "items": [
    {
      "word": "rabbit",
      "answer": "토끼",
      "options": ["고양이", "강아지", "사자"]
    },
    {
      "word": "hungry",
      "answer": "배고픈",
      "options": ["행복한", "슬픈", "졸린"]
    }
  ]
}
```

### 12.3 이해도 퀴즈 (comprehension)

```json
{
  "items": [
    {
      "question": "What did the rabbit find?",
      "options": ["A carrot", "An apple", "A banana", "A tomato"],
      "answer": 0
    },
    {
      "question": "Where was the carrot?",
      "options": ["In the house", "In the garden", "In the forest", "In the river"],
      "answer": 1
    }
  ]
}
```

---

## 13. 기술 스택 (예정)

| 항목           | 기술                   |
| -------------- | ---------------------- |
| 부모/어드민 웹 | PC 웹 (프레임워크 TBD) |
| 자녀 앱        | Flutter                |
| TTS            | Amazon Polly (Neural)  |
| 콘텐츠 생성    | GPT                    |

---

_문서 버전: v4.0_
_최종 수정일: 2025년 1월_
